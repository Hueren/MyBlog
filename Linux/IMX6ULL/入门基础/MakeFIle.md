## 语法：

```makefile
目标：依赖
    指令1
    指令2
    ...
```

```makefile
main: main.o input.o calcu.o
    gcc -o main main.o input.o calcu.o         
```

```makefile
clean:
    rm *.o
    rm main
```

<mark>`Makefile`所有首行需要空出来的地方一定要使用`TAB`键</mark>

`:wq`退出`linux`编辑器

### 变量

```makefile
#变量引用方法：$(变量名)
objects = main.o input.o calcu.o
main: $(objects)
    gcc -o mian $(objects)
```

### 赋值符号

`“=”`延时赋值。借助另一个变量，可以将变量的真实值推到后面去定义。即变量的真实值取决于它所引用的变量的最后一次有效值。

`“:=”`立即赋值。不使用后面定义的变量，只能使用前面定义好的变量。

`"?="`如果变量没赋值就使用等号后面的变量，如果赋值过就使用前面赋的值。

`"+="`追加变量。

### 模式规则

`"%"`表示任意长度的非空字符串，类似通配符

### 自动化变量

| 自动化变量 | 说明                                            |
|:-----:|:---------------------------------------------:|
| `$@`  | 规则中的目标集合，在模式规则中如果有多个目标，表示匹配模式中定义的目标集合         |
| `$<`  | 依赖文件集合中的第一个文件。如果依赖文件以`"%"`定义，表示符合模式的一系列文件的集合。 |
| `$^`  | 所有依赖文件的集合，使用空格分开，如果有多个重复文件，则只保留一份             |

### 伪目标

 伪目标是为了避免Makefile中定义的只执行命令的目标和工作目录下的实际文件出现名字冲突。

`.PHONY:目标名`

```makefile
.PHONY:clean
clean:
    rm *.o
    rm main
```

## 函数

| 函数         | 功能  |
|:----------:|:---:|
| filter     |     |
| filter-out |     |
| wildcard   |     |
| patsubst   |     |

## 实例

#### 支持头文件依赖

| 命令                            | 作用               |
| ----------------------------- | ---------------- |
| gcc -M c.c                    | 打印出依赖            |
| gcc -M -MF c.d c.c            | 把依赖写入文件c.d       |
| gcc -c -o c.o c.c -MD -MF c.d | 编译c.o，把依赖写入文件c.d |

## 通用Makefile
